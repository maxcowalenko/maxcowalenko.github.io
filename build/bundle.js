var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function u(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function i(t){return document.createElement(t)}function s(t){return document.createTextNode(t)}function f(){return s(" ")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function d(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function h(t,e){t.value=null==e?"":e}let m;function $(t){m=t}const b=[],y=[],S=[],v=[],x=Promise.resolve();let w=!1;function _(t){S.push(t)}let E=!1;const k=new Set;function R(){if(!E){E=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];$(e),A(e.$$)}for($(null),b.length=0;y.length;)y.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];k.has(e)||(k.add(e),e())}S.length=0}while(b.length);for(;v.length;)v.pop()();w=!1,E=!1,k.clear()}}function A(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const P=new Set;function j(t,e){-1===t.$$.dirty[0]&&(b.push(t),w||(w=!0,x.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function C(u,l,c,i,s,f,p=[-1]){const d=m;$(u);const g=u.$$={fragment:null,ctx:null,props:f,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:l.context||[]),callbacks:n(),dirty:p,skip_bound:!1};let h=!1;if(g.ctx=c?c(u,l.props||{},((t,e,...n)=>{const r=n.length?n[0]:e;return g.ctx&&s(g.ctx[t],g.ctx[t]=r)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](r),h&&j(u,t)),e})):[],g.update(),h=!0,r(g.before_update),g.fragment=!!i&&i(g.ctx),l.target){if(l.hydrate){const t=function(t){return Array.from(t.childNodes)}(l.target);g.fragment&&g.fragment.l(t),t.forEach(a)}else g.fragment&&g.fragment.c();l.intro&&((b=u.$$.fragment)&&b.i&&(P.delete(b),b.i(y))),function(t,n,u,l){const{fragment:c,on_mount:a,on_destroy:i,after_update:s}=t.$$;c&&c.m(n,u),l||_((()=>{const n=a.map(e).filter(o);i?i.push(...n):r(n),t.$$.on_mount=[]})),s.forEach(_)}(u,l.target,l.anchor,l.customElement),R()}var b,y;$(d)}function N(t,e,n){const r=t.slice();return r[2]=e[n].text,r[13]=e[n].active,r[15]=n,r}function O(t){let e,n=t[0],r=[];for(let e=0;e<n.length;e+=1)r[e]=T(N(t,n,e));return{c(){e=i("div");for(let t=0;t<r.length;t+=1)r[t].c();d(e,"class","list-group overflow-auto svelte-1624oyi")},m(t,n){c(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(9&o){let u;for(n=t[0],u=0;u<n.length;u+=1){const l=N(t,n,u);r[u]?r[u].p(l,o):(r[u]=T(l),r[u].c(),r[u].m(e,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=n.length}},d(t){t&&a(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(r,t)}}}function T(t){let e,n,r,o,u,h,m=t[2]+"";function $(){return t[6](t[15])}return{c(){e=i("button"),n=s(m),r=f(),d(e,"type","button"),d(e,"class",o="list-group-item list-group-item-action text-truncate "+t[13]+" svelte-1624oyi")},m(t,o){c(t,e,o),l(e,n),l(e,r),u||(h=p(e,"click",$),u=!0)},p(r,u){t=r,1&u&&m!==(m=t[2]+"")&&g(n,m),1&u&&o!==(o="list-group-item list-group-item-action text-truncate "+t[13]+" svelte-1624oyi")&&d(e,"class",o)},d(t){t&&a(e),u=!1,h()}}}function q(e){let n,o,u,m,$,b,y,S,v,x,w,_=e[1]?"Pause":"Play",E=0<e[0].length&&O(e);return{c(){n=i("main"),o=i("div"),u=i("form"),m=i("div"),$=i("textarea"),b=f(),y=i("button"),S=s(_),v=f(),E&&E.c(),d($,"class","form-control svelte-1624oyi"),d($,"placeholder","Text to read"),d($,"rows","1"),d(y,"class","btn btn-outline-secondary"),d(m,"class","input-group mb-3"),d(o,"class","container vh-100 pt-3 pb-3 my-flex svelte-1624oyi")},m(t,r){var a;c(t,n,r),l(n,o),l(o,u),l(u,m),l(m,$),h($,e[2]),l(m,b),l(m,y),l(y,S),l(o,v),E&&E.m(o,null),x||(w=[p($,"input",e[5]),p(u,"submit",(a=e[4],function(t){return t.preventDefault(),a.call(this,t)}))],x=!0)},p(t,[e]){4&e&&h($,t[2]),2&e&&_!==(_=t[1]?"Pause":"Play")&&g(S,_),0<t[0].length?E?E.p(t,e):(E=O(t),E.c(),E.m(o,null)):E&&(E.d(1),E=null)},i:t,o:t,d(t){t&&a(n),E&&E.d(),x=!1,r(w)}}}function L(t,e,n){let r="",o=0,u=[],l=new Audio,c=!1;l.onended=()=>a(),l.onplaying=()=>n(1,c=!0),l.onpause=()=>n(1,c=!1);let a=()=>{o<u.length&&(c&&l.pause(),0<o&&n(0,u[o-1].active="",u),n(0,u[o].active="active",u),l.src=`https://tts.voicetech.yandex.net/tts?format=mp3&speed=1.25&quality=hi&lang=ru_RU&emotion=neutral&text=${encodeURIComponent(u[o++].text)}`,l.play())},i=t=>{n(0,u[o-1].active="",u),o=t,a()};return[u,c,r,i,()=>{let t=`${r.trim()}`;n(2,r=""),0<t.length?(n(0,u=(t=>{let e=`${t}`;e=e.replace(new RegExp("[s+|\t+|\v+|\n+]","g")," "),e=e.replace(new RegExp(" +","g")," "),[{pattern:"-+",newSubStr:"-"},{pattern:"—+",newSubStr:"-"},{pattern:"\\*+",newSubStr:"*"},{pattern:"([0-9]) ([0-9])",newSubStr:"$1$2"},{pattern:"([0-9]),([0-9])",newSubStr:"$1$2"},{pattern:"([0-9]).([0-9])",newSubStr:"$1$2"},{pattern:"ѐ",newSubStr:"е"},{pattern:"<",newSubStr:" "},{pattern:">",newSubStr:" "},{pattern:"«",newSubStr:'"'},{pattern:"»",newSubStr:'"'},{pattern:"\\? ",newSubStr:"?."},{pattern:"! ",newSubStr:"!."},{pattern:"; ",newSubStr:";."}].forEach((({pattern:t,newSubStr:n})=>e=e.replace(new RegExp(t,"g"),n)));let n=e.split("."),r=[""],o=0;return n.forEach((t=>{if(0<t.trim().length){r[o].length+t.length<1e3||(r.push(""),o++);let e="";new RegExp("[\\?|!|;]$","g").test(t.trim())||(e="."),r[o]+=`${t.trim()}${e} `}})),r.map((t=>({text:t,active:""})))})(t)),o=0,a()):c?l.pause():l.play()},function(){r=this.value,n(2,r)},t=>i(t)]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),C(this,t,L,q,u,{})}}({target:document.body})}();
